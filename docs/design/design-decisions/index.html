<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta property="og:title" content="Decisions" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://finetuner.jina.ai/design/design-decisions.html" />
  <meta property="og:site_name" content="Finetuner Documentation" />
  <meta property="og:description" content="Single API with minimum arguments: Finetuner exposes only one public API as the entrypoint: finetuner.fit. At its minimum form, it requires only two arguments: the model and the data. The interface of Tuner, Tailor and Labeler must comply with this single API: Use Labeler import finetuner as ft f..." />
  <meta property="og:image" content="../../_images/poster.gif" />
  <meta property="og:image:alt" content="Finetuner Documentation" />
  <meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@JinaAI_">
<meta name="twitter:creator" content="@JinaAI_">
<meta name="description" content="Finetuner allows one to finetune any deep neural network for better embedding on search tasks.">
<meta property="og:description" content="Finetuner allows one to finetune any deep neural network for better embedding on search tasks.">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1ESRNDCK35"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1ESRNDCK35');
</script>
    <link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" />

    <link rel="shortcut icon" href="../../_static/favicon.png"/><meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>Decisions - Finetuner 0.0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.d53ab927f7bad3eaa42da95908504b10.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: #4d4d4d;
  --color-brand-primary: #009191;
  --color-brand-content: #009191;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
    <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
    <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
    <header class="mobile-header">
        <div class="header-left">
            <label class="nav-overlay-icon" for="__navigation">
                <div class="visually-hidden">Toggle site navigation sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-menu"></use>
                    </svg>
                </i>
            </label>
        </div>
        <div class="header-center">
            <a href="../../">
                <div class="brand">Finetuner 0.0.3 documentation</div>
            </a>
        </div>
        <div class="header-right">
            <div class="theme-toggle-container theme-toggle-header">
                <button class="theme-toggle">
                    <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                    <svg class="theme-icon-when-auto">
                        <use href="#svg-sun-half"></use>
                    </svg>
                    <svg class="theme-icon-when-dark">
                        <use href="#svg-moon"></use>
                    </svg>
                    <svg class="theme-icon-when-light">
                        <use href="#svg-sun"></use>
                    </svg>
                </button>
            </div>
            <label class="toc-overlay-icon toc-header-icon" for="__toc">
                <div class="visually-hidden">Toggle table of contents sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-toc"></use>
                    </svg>
                </i>
            </label>
        </div>
    </header>
    <aside class="sidebar-drawer">
        <div class="sidebar-container">
            
            <div class="sidebar-sticky"><a class="sidebar-brand" href="../../">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/logo-light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/logo-dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/fashion-mnist/">Finetuning MLP on Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/covid-qa/">Finetuning Bi-LSTM on Text</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../basics/fit/">One-liner <code class="docutils literal notranslate"><span class="pre">fit()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../basics/data-format/">Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../basics/glossary/">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../components/overview/">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components/tuner/">Tuner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components/tailor/">Tailor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components/labeler/">Labeler</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/finetuner/">finetuner package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/finetuner.labeler/">finetuner.labeler package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/finetuner.labeler.executor/">finetuner.labeler.executor module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/finetuner.tailor/">finetuner.tailor package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/finetuner.tailor.keras/">finetuner.tailor.keras package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/finetuner.tailor.paddle/">finetuner.tailor.paddle package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/finetuner.tailor.pytorch/">finetuner.tailor.pytorch package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/finetuner.tailor.base/">finetuner.tailor.base module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/finetuner.tuner/">finetuner.tuner package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/finetuner.tuner.dataset/">finetuner.tuner.dataset package</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/finetuner.tuner.dataset.helper/">finetuner.tuner.dataset.helper module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/finetuner.tuner.keras/">finetuner.tuner.keras package</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/finetuner.tuner.keras.datasets/">finetuner.tuner.keras.datasets module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/finetuner.tuner.keras.losses/">finetuner.tuner.keras.losses module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/finetuner.tuner.paddle/">finetuner.tuner.paddle package</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/finetuner.tuner.paddle.datasets/">finetuner.tuner.paddle.datasets module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/finetuner.tuner.paddle.losses/">finetuner.tuner.paddle.losses module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/finetuner.tuner.pytorch/">finetuner.tuner.pytorch package</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/finetuner.tuner.pytorch.datasets/">finetuner.tuner.pytorch.datasets module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/finetuner.tuner.pytorch.losses/">finetuner.tuner.pytorch.losses module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/finetuner.tuner.base/">finetuner.tuner.base module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/finetuner.tuner.logger/">finetuner.tuner.logger module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/finetuner.helper/">finetuner.helper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/finetuner.toydata/">finetuner.toydata module</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ecosystem</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/jina-ai/jina">Jina</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hub.jina.ai">Jina Hub</a></li>
</ul>

</div>
</div>
            </div>
            
        </div>
    </aside>
    <div class="main">
        <div class="content">
            <article role="main">
                <div class="content-icon-container">
                    <div class="theme-toggle-container theme-toggle-content">
                        <button class="theme-toggle">
                            <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                            <svg class="theme-icon-when-auto">
                                <use href="#svg-sun-half"></use>
                            </svg>
                            <svg class="theme-icon-when-dark">
                                <use href="#svg-moon"></use>
                            </svg>
                            <svg class="theme-icon-when-light">
                                <use href="#svg-sun"></use>
                            </svg>
                        </button>
                    </div>
                    <label class="toc-overlay-icon toc-content-icon"
                           for="__toc">
                        <div class="visually-hidden">Toggle table of contents sidebar</div>
                        <i class="icon">
                            <svg>
                                <use href="#svg-toc"></use>
                            </svg>
                        </i>
                    </label>
                </div>
                <section class="tex2jax_ignore mathjax_ignore" id="decisions">
<span id="design-decision"></span><h1>Decisions<a class="headerlink" href="#decisions" title="Permalink to this headline">¶</a></h1>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This section is not meant to be public. It is a collection of my thoughts on the high-level design &amp; positioning of the Finetuner project in the Jina AI landscape. Please do not share any content below.</p>
<p>Some of the paragraph may be published later after my revision.</p>
</div>
<section id="single-api-with-minimum-arguments">
<h2>Single API with minimum arguments<a class="headerlink" href="#single-api-with-minimum-arguments" title="Permalink to this headline">¶</a></h2>
<p>Finetuner exposes only one public API as the entrypoint: <code class="docutils literal notranslate"><span class="pre">finetuner.fit</span></code>. At its minimum form, it requires only two arguments: the model and the data.</p>
<p>The interface of <code class="docutils literal notranslate"><span class="pre">Tuner</span></code>,  <code class="docutils literal notranslate"><span class="pre">Tailor</span></code> and <code class="docutils literal notranslate"><span class="pre">Labeler</span></code> must comply with this single API:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"/><label class="tab-label" for="tab-set--0-input--1">Use Labeler</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">finetuner</span> <span class="k">as</span> <span class="nn">ft</span>

<span class="n">ft</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">embed_model</span><span class="p">,</span>
       <span class="n">train_data</span>
<span class="hll">       <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"/><label class="tab-label" for="tab-set--0-input--2">Use Tuner with Tailor</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">finetuner</span> <span class="k">as</span> <span class="nn">ft</span>

<span class="hll"><span class="n">ft</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">general_model</span><span class="p">,</span>
</span>       <span class="n">train_data</span><span class="p">,</span>
<span class="hll">       <span class="n">freeze_layer</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span class="hll">       <span class="n">output_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--3" name="tab-set--0" type="radio"/><label class="tab-label" for="tab-set--0-input--3">Use Tuner</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">finetuner</span> <span class="k">as</span> <span class="nn">ft</span>

<span class="hll"><span class="n">ft</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">embed_model</span><span class="p">,</span>
</span>       <span class="n">train_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>All other arguments are considered as optional and their default values should be carefully chosen by us (i.e. the developer of Finetuner).</p>
<p>Unlike Jina that aims at flexibility, Finetuner provides users a <strong>managed</strong>, <strong>finetuning</strong> experience <strong>inside Jina ecosystem</strong>. For Finetuner, “flexibility” means having more <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> in <code class="docutils literal notranslate"><span class="pre">finetuner.fit</span></code>.</p>
</section>
<section id="three-pillars-design">
<span id="embedding-model"></span><h2>Three pillars design<a class="headerlink" href="#three-pillars-design" title="Permalink to this headline">¶</a></h2>
<p>To understand why <code class="docutils literal notranslate"><span class="pre">Tuner</span></code>, <code class="docutils literal notranslate"><span class="pre">Labeler</span></code>, <code class="docutils literal notranslate"><span class="pre">Tailor</span></code> three pillars exist, let me first clarify the two concepts:</p>
<ul class="simple">
<li><p><strong>Embedding model</strong>: a DNN takes an arbitary <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> input (image/text/sequence) with size <code class="docutils literal notranslate"><span class="pre">[B</span> <span class="pre">x</span> <span class="pre">...</span> <span class="pre">x</span> <span class="pre">...</span> <span class="pre">x</span> <span class="pre">...]</span></code> and output a <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> with size <code class="docutils literal notranslate"><span class="pre">[B</span> <span class="pre">x</span> <span class="pre">D]</span></code>, where <code class="docutils literal notranslate"><span class="pre">B</span></code> is the batch size and the embedded vector is in <span class="math notranslate nohighlight">\(R^D\)</span>.</p></li>
<li><p><strong>General model</strong>: a DNN model that does not output <code class="docutils literal notranslate"><span class="pre">[B</span> <span class="pre">x</span> <span class="pre">D]</span></code>. For example, classification model, objective detection model, next token prediction model, regression model are not embedding model as their output is not a batch of <span class="math notranslate nohighlight">\(R^D\)</span> vectors.</p></li>
</ul>
<p>Despite the difference on the model architecture, the weights also differs. The weights of a general model is often trained end-to-endly for a specific task. The weights of an embedding model is often initialized from a general model, but then truncated and tuned for a new downstream task.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In my previous slides/talks, I sometimes called the embedding model as bottleneck model, or a model with a bottleneck layer.</p>
</div>
<section id="tuner">
<h3>Tuner<a class="headerlink" href="#tuner" title="Permalink to this headline">¶</a></h3>
<p>In a Jina pipeline, the embedding model is the important component for getting the representation. The quality of this representation often directly determines the search quality. On contrary, the general model is nothing interesting to Jina.</p>
<p>That is, tuning the performance of the search equals to tuning the embedding model. <a class="reference internal" href="../overview/#three-pillars"><span class="std std-ref">This is exactly the definition of Tuner</span></a>.</p>
<p>The actual training of Finetuner happens inside the Tuner.</p>
</section>
<section id="tailor">
<h3>Tailor<a class="headerlink" href="#tailor" title="Permalink to this headline">¶</a></h3>
<p>But where does this embedding model come from? As I said, general models widely exist, and only few of them can be directly used as embedding models. So how can one get a embedding model? There are two ways:</p>
<ul class="simple">
<li><p>building from scratch;</p></li>
<li><p>converting a general model to a embedding model.</p></li>
</ul>
<p>In <a class="reference external" href="https://hanxiao.io/2019/07/29/Generic-Neural-Elastic-Search-From-bert-as-service-and-Go-Way-Beyond/?highlight=body%20%3E%20div.wrap%20%3E%20main%20%3E%20div%20%3E%20article%20%3E%20div.post-content%20%3E%20img:nth-child(26)">my blog post on the new AI supply chain</a>, I already said less &amp; less people will build new model from scratch. Most people will simply use pretrained or preachitectured models. Hence there is a strong &amp; common requirement of “converting” arbitrary general DNN model into embedding model that Tuner could handle. That’s what tailor responsible for.</p>
<p>Given a general model (from your colleague or Pytorch/Keras/Huggingface model zoo), Tailor trims, cuts and does micro-operations on its architecture and outputs an embedding model for the Tuner.</p>
<p>Tailor can be considered as a funnel, which enlarges our model landscape and speeds up the adoption of the Finetuner project.</p>
</section>
<section id="labeler">
<h3>Labeler<a class="headerlink" href="#labeler" title="Permalink to this headline">¶</a></h3>
<p>I have talked about models and tuning. To conduct training we also need labeled data. That’s the job of the labeler: to allow human to interactively label search results. Labeler delivers more than a simple annotation UI, it is also responsible for invoking Tuner to do <a class="reference external" href="https://en.wikipedia.org/wiki/Active_learning_(machine_learning)">active learning</a>, so that the next to-be-labeled data is selected according to the latest tuned embedding model.</p>
</section>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Tuner</strong>: to tune any embedding model for better embedding on labeled data;</p></li>
<li><p><strong>Tailor</strong>: to trim any deep neural network into an embedding model;</p></li>
<li><p><strong>Labeler</strong>: a UI for interactive labeling and conduct <a class="reference external" href="https://en.wikipedia.org/wiki/Active_learning_(machine_learning)">active learning</a> via Tuner.</p></li>
</ul>
<p>Let’s summarize all user entrypoints here</p>
<div class="table-wrapper"><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>User</p></th>
<th class="head"><p>Entrypoint</p></th>
<th class="head"><p>Est. Quantity</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Users that have no labeled data</p></td>
<td><p>Labeler (calls Tuner and Tailor in the back)</p></td>
<td><p>Majority</p></td>
</tr>
<tr class="row-odd"><td><p>Users that have no labeled data but have embedding model</p></td>
<td><p>Labeler (calls Tuner in the back)</p></td>
<td><p>Majority</p></td>
</tr>
<tr class="row-even"><td><p>Users that have labeled data</p></td>
<td><p>Tuner (calls Tailor in the back)</p></td>
<td><p>Minority</p></td>
</tr>
<tr class="row-odd"><td><p>Users that have labeled data and an embedding model</p></td>
<td><p>Tuner</p></td>
<td><p>Minority</p></td>
</tr>
</tbody>
</table></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The term <code class="docutils literal notranslate"><span class="pre">Tuner</span></code>, <code class="docutils literal notranslate"><span class="pre">Tailor</span></code>, <code class="docutils literal notranslate"><span class="pre">Labeler</span></code> are partially inspired by the movie “Tinker Tailor Soldier Spy”.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/poster.gif"><img alt="../../_images/poster.gif" src="../../_images/poster.gif" style="height: 200px;"/></a>
</figure>
</div>
</section>
</section>
<section id="relationship-with-jina">
<h2>Relationship with Jina<a class="headerlink" href="#relationship-with-jina" title="Permalink to this headline">¶</a></h2>
<p>Finetuner is not designed to be a general finetuning framework, it fills the gap of the last mile delivery <strong>for Jina users</strong>.</p>
<p>Finetuner is not an independent project. It has one mandatory upstream dependency: Jina.</p>
<p>In particular, Finetuner is implemented as follows to maximize the compatability with Jina:</p>
<ul class="simple">
<li><p>The data exchange format of Tuner &amp; Labeler is <code class="docutils literal notranslate"><span class="pre">DocumentArray</span></code> or <code class="docutils literal notranslate"><span class="pre">DocumentArrayMemmap</span></code>, where each sample data is a <code class="docutils literal notranslate"><span class="pre">Document</span></code>. The rich structure of <code class="docutils literal notranslate"><span class="pre">Document</span></code> gets fully leveraged by Finetuner.</p></li>
<li><p>Labeler leverages Jina <code class="docutils literal notranslate"><span class="pre">Flow</span></code> as the backend to train the model on-the-fly.</p></li>
</ul>
</section>
<section id="dl-backend-support">
<h2>DL backend support<a class="headerlink" href="#dl-backend-support" title="Permalink to this headline">¶</a></h2>
<p>The decision on supporting Pytorch, Keras and Paddle as deep learning backend is fixed. We shall try our best effort to maintain a consistent behavior across these three backends. This will make the Finetuner project framework-agnostic, and serve better our diversified community.</p>
<p>This decision mostly affect the implementation and design of <code class="docutils literal notranslate"><span class="pre">Tuner</span></code> and <code class="docutils literal notranslate"><span class="pre">Tailor</span></code>. In particular, <code class="docutils literal notranslate"><span class="pre">Tuner</span></code> is a good example to show such requirement can be done beautifully. Please read the source code behind Tuner and observe the unified interface there.</p>
<p>On the high-level API, PyTorch and Paddle look and feel extremely similar. This reduces 1/3 our development effort. Paddle is also popular in China. By working with Baidu on promoting Finetuner (scheduled a big press release from them in Nov. 2021), this gives us good exposure to Paddle community.</p>
<p>This decision does not affect the implementation of <code class="docutils literal notranslate"><span class="pre">Labeler</span></code>, as it can be seen as UI + <code class="docutils literal notranslate"><span class="pre">Flow</span></code> + <code class="docutils literal notranslate"><span class="pre">Tuner</span></code> + <code class="docutils literal notranslate"><span class="pre">Tailor</span></code>, where the first two components are framework-irrelevant.</p>
</section>
</section>

            </article>
            <footer>
                
                <div class="related-pages">
                    
                    
                </div>

                <div class="related-information sd-d-inline-flex">
                    <a href="https://jina.ai">Copyright &#169; Jina AI Limited. All rights reserved.</a>
                    Last updated on Oct 19, 2021.
                    <div class="social-btns">
                    <a class='social-btn' href="https://github.com/jina-ai/jina/" target="_blank"> <i class="fab fa-github"></i></a>
                    <a class='social-btn' href="https://slack.jina.ai" target="_blank"> <i class="fab fa-slack"></i></a>
                    <a class='social-btn' href="https://youtube.com/c/jina-ai" target="_blank"> <i class="fab fa-youtube"></i></a>
                    <a class='social-btn' href="https://twitter.com/JinaAI_" target="_blank"> <i class="fab fa-twitter"></i></a>
                    <a class='social-btn' href="https://www.linkedin.com/company/jinaai/" target="_blank"> <i class="fab fa-linkedin"></i></a>
                    </div>
                </div>
                
            </footer>
        </div>
        <aside class="toc-drawer">
            

            <div class="toc-sticky toc-scroll">
                
                <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
                </div>
                <div class="toc-tree-container">
                    <div class="toc-tree">
                        <ul>
<li><a class="reference internal" href="#">Decisions</a><ul>
<li><a class="reference internal" href="#single-api-with-minimum-arguments">Single API with minimum arguments</a></li>
<li><a class="reference internal" href="#three-pillars-design">Three pillars design</a><ul>
<li><a class="reference internal" href="#tuner">Tuner</a></li>
<li><a class="reference internal" href="#tailor">Tailor</a></li>
<li><a class="reference internal" href="#labeler">Labeler</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li><a class="reference internal" href="#relationship-with-jina">Relationship with Jina</a></li>
<li><a class="reference internal" href="#dl-backend-support">DL backend support</a></li>
</ul>
</li>
</ul>

                    </div>
                </div>
                
            </div>

            
        </aside>

    </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/main.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    </body>
</html>